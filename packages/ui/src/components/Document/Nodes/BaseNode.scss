@use '../../../styles/dnd';

.node {
  &__row {
    --rank-margin: calc(var(--node-rank, 0) * 0.85rem);

    display: flex;
    flex-flow: row nowrap;
    align-items: center;
    height: var(--datamapper-node-row-height, 2rem);
    font-size: var(--datamapper-node-font-size, 0.875rem);
    position: relative;

    // Rank-based indentation - expand icon + margins = ~1.5rem per level
    margin-left: var(--rank-margin);

    &[data-draggable='true'] {
      @include dnd.cursor-grab;
    }

    // Leaf nodes (no children) have grey font color
    &:not([data-expandable='true']) {
      color: var(--pf-t--global--color--text--subtle);
      border-left: 1px dotted gray;
      padding-left: var(--pf-t--global--spacer--sm);
    }

    // Make inputs/buttons fit within row height
    // stylelint-disable-next-line selector-class-pattern
    .pf-v6-c-action-list__item,
    .pf-v6-c-input-group {
      height: var(--datamapper-input-height, 1.75rem);
    }

    .pf-v6-c-input-group {
      flex: 1;
    }

    input,
    button,
    .pf-v6-c-text-input,
    .pf-v6-c-button {
      height: var(--datamapper-input-height, 1.75rem);
      font-size: var(--datamapper-node-font-size, 0.875rem);
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }

  // Selected row styling - blue font color and bold (overrides leaf node grey)
  &__row[data-selected='true'] {
    color: var(--pf-t--global--color--brand--default) !important;
    font-weight: bold;
  }

  &__expand {
    left: var(--pf-t--global--spacer--sm);

    svg {
      width: calc(1rem * var(--datamapper-scale-factor, 1));
      height: calc(1rem * var(--datamapper-scale-factor, 1));
    }
  }

  &__spacer {
    margin: 0 var(--pf-t--global--spacer--sm);

    svg {
      display: block;
      width: calc(1rem * var(--datamapper-scale-factor, 1));
      height: calc(1rem * var(--datamapper-scale-factor, 1));
    }
  }

  &__connection-port {
    position: absolute;
    pointer-events: none;
    top: 50%;
    transform: translateY(-50%);

    &--source {
      right: 10px;
    }

    &--target {
      left: calc(var(--rank-margin) * -0.7);
    }
  }
}
